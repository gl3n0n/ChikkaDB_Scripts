DROP TABLE powerapp_brand_dailyrep;
CREATE TABLE powerapp_brand_dailyrep (
 tran_dt  date NOT NULL,
 plan     varchar(20) not null,
 hits_pre int(11) default 0 not null,
 hits_ppd int(11) default 0 not null,
 hits_tnt int(11) default 0 not null,
 hits_tot int(11) default 0 not null,
 uniq_pre int(11) default 0 not null,
 uniq_ppd int(11) default 0 not null,
 uniq_tnt int(11) default 0 not null,
 uniq_tot int(11) default 0 not null,
 primary key(tran_dt, plan)
);

DROP TABLE powerapp_brand_expiry_dailyrep;
CREATE TABLE powerapp_brand_expiry_dailyrep (
 tran_dt  date NOT NULL,
 plan     varchar(20) not null,
 plan_exp varchar(20) not null,
 hits_pre int(11) default 0 not null,
 hits_ppd int(11) default 0 not null,
 hits_tnt int(11) default 0 not null,
 hits_tot int(11) default 0 not null,
 uniq_pre int(11) default 0 not null,
 uniq_ppd int(11) default 0 not null,
 uniq_tnt int(11) default 0 not null,
 uniq_tot int(11) default 0 not null,
 primary key(tran_dt, plan, plan_exp)
);

 
DROP PROCEDURE IF EXISTS sp_generate_hi10_brand_stats;
delimiter //
CREATE PROCEDURE sp_generate_hi10_brand_stats(p_date date)
begin
   delete from powerapp_brand_dailyrep where tran_dt = p_date;
   delete from powerapp_brand_expiry_dailyrep where tran_dt = p_date;
   select count(1) into @brandIsNull from powerapp_optout_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and brand is null;
   if @brandIsNull > 0 then
      call sp_optout_add_brand(p_date);
   end if;

   insert into powerapp_brand_dailyrep
   select tran_dt, plan, sum(hits_pre), sum(hits_ppd), sum(hits_tnt), sum(hits_tot), sum(uniq_pre), sum(uniq_ppd), sum(uniq_tnt), sum(uniq_tot) from (
   select left(datein, 10) tran_dt, plan, count(1) hits_pre, 0 hits_ppd, 0 hits_tnt, 0 hits_tot, count(distinct phone) uniq_pre, 0 uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' and brand='BUDDY' group by tran_dt, plan union
   select left(datein, 10) tran_dt, plan, 0 hits_pre, count(1) hits_ppd, 0 hits_tnt, 0 hits_tot, 0 uniq_pre, count(distinct phone) uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' and brand='POSTPD' group by tran_dt, plan union
   select left(datein, 10) tran_dt, plan, 0 hits_pre, 0 hits_ppd, count(1) hits_tnt, 0 hits_tot, 0 uniq_pre, 0 uniq_ppd, count(distinct phone) uniq_tnt, 0 uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' and brand='TNT' group by tran_dt, plan union
   select left(datein, 10) tran_dt, plan, 0 hits_pre, 0 hits_ppd, 0 hits_tnt, count(1) hits_tot, 0 uniq_pre, 0 uniq_ppd, 0 uniq_tnt, count(distinct phone) uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' group by tran_dt, plan 
   ) temp_table group by tran_dt, plan;


   insert into powerapp_brand_expiry_dailyrep
   select tran_dt, plan, plan_exp, sum(hits_pre), sum(hits_ppd), sum(hits_tnt), sum(hits_tot), sum(uniq_pre), sum(uniq_ppd), sum(uniq_tnt), sum(uniq_tot) from (
   select left(datein, 10) tran_dt, plan, IF(validity<86400, '3H', '24H') plan_exp, count(1) hits_pre, 0 hits_ppd, 0 hits_tnt, 0 hits_tot, count(distinct phone) uniq_pre, 0 uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' and brand='BUDDY' group by tran_dt, plan, plan_exp union
   select left(datein, 10) tran_dt, plan, IF(validity<86400, '3H', '24H') plan_exp, 0 hits_pre, count(1) hits_ppd, 0 hits_tnt, 0 hits_tot, 0 uniq_pre, count(distinct phone) uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' and brand='POSTPD' group by tran_dt, plan, plan_exp union
   select left(datein, 10) tran_dt, plan, IF(validity<86400, '3H', '24H') plan_exp, 0 hits_pre, 0 hits_ppd, count(1) hits_tnt, 0 hits_tot, 0 uniq_pre, 0 uniq_ppd, count(distinct phone) uniq_tnt, 0 uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' and brand='TNT' group by tran_dt, plan, plan_exp union
   select left(datein, 10) tran_dt, plan, IF(validity<86400, '3H', '24H') plan_exp, 0 hits_pre, 0 hits_ppd, 0 hits_tnt, count(1) hits_tot, 0 uniq_pre, 0 uniq_ppd, 0 uniq_tnt, count(distinct phone) uniq_tot from powerapp_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and free='false' group by tran_dt, plan, plan_exp 
   ) temp_table group by tran_dt, plan, plan_exp;

   insert into powerapp_brand_dailyrep
   select tran_dt, 'OPTOUT', sum(hits_pre), sum(hits_ppd), sum(hits_tnt), sum(hits_tot), sum(uniq_pre), sum(uniq_ppd), sum(uniq_tnt), sum(uniq_tot) from (
   select left(datein, 10) tran_dt, count(1) hits_pre, 0 hits_ppd, 0 hits_tnt, 0 hits_tot, 0 uniq_pre, 0 uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_optout_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and brand='BUDDY' group by tran_dt union
   select left(datein, 10) tran_dt, 0 hits_pre, count(1) hits_ppd, 0 hits_tnt, 0 hits_tot, 0 uniq_pre, 0 uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_optout_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and brand='POSTPD' group by tran_dt union
   select left(datein, 10) tran_dt, 0 hits_pre, 0 hits_ppd, count(1) hits_tnt, 0 hits_tot, 0 uniq_pre, 0 uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_optout_log where datein >= p_date and datein < date_add(p_date, interval 1 day) and brand='TNT' group by tran_dt union
   select left(datein, 10) tran_dt, 0 hits_pre, 0 hits_ppd, 0 hits_tnt, count(1) hits_tot, 0 uniq_pre, 0 uniq_ppd, 0 uniq_tnt, 0 uniq_tot from powerapp_optout_log where datein >= p_date and datein < date_add(p_date, interval 1 day) group by tran_dt 
   ) temp_table group by tran_dt;

   insert ignore powerapp_brand_dailyrep 
   select p_date, plan, 0, 0, 0, 0, 0, 0, 0, 0 from powerapp_brand_expiry_dailyrep group by plan;

   insert ignore powerapp_brand_expiry_dailyrep 
   select p_date, plan, plan_exp, 0, 0, 0, 0, 0, 0, 0, 0 from powerapp_brand_expiry_dailyrep group by plan, plan_exp;
END;
//
delimiter ; 

ALTER TABLE powerapp_optout_log ADD brand VARCHAR(10);
DROP PROCEDURE IF EXISTS sp_optout_add_brand;
DELIMITER //
CREATE PROCEDURE sp_optout_add_brand (p_date varchar(10))
BEGIN
   declare vPattern, vBrand Varchar(120);
   declare done_p int default 0;
   declare c_pat cursor for select pattern, sim_type
                            from  mobile_pattern
                            where operator = 'SMART'
                            and sim_type <> 'BUDDY';
   declare continue handler for sqlstate '02000' set done_p = 1;
   
   OPEN c_pat;
   REPEAT
      FETCH c_pat into vPattern, vBrand;
      if not done_p then
         SET @vSql = concat('update powerapp_optout_log set brand=''', vBrand, ''' where datein >=''', p_date, ''' and datein < date_add(''', p_date,''', interval 1 day) and brand is null and phone REGEXP ''', vPattern, '''');
         PREPARE stmt FROM @vSql;
         EXECUTE stmt;
         DEALLOCATE PREPARE stmt;
      end if;
   UNTIL done_p
   END REPEAT;
   -- Update all brand, still null, to PREPAID... 
   UPDATE powerapp_optout_log set brand = 'BUDDY' where datein >= p_date and datein < date_add(p_date, interval 1 day) and brand is null; 
end;
//
DELIMITER ;

CREATE TABLE mobile_pattern (
  operator varchar(15) NOT NULL,
  sim_type varchar(20) NOT NULL,
  pattern varchar(150) NOT NULL,
  notes varchar(100) DEFAULT NULL,
  KEY pattern_idx (pattern)
);

insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)90885[0-9]{5,5}$', 'Smart Infinity 0908 series: 85x xxxx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)90880[0-2][0-1][0-1][0-9]{2,2}$', 'Smart Infinity 0908 series: 8800000 to 8802119');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9188[0-9]{6,6}$', 'Smart Infinity 0918 series: 8xx xxxx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)92888[0-9]{5,5}$', 'Smart Infinity 0928 series: 88x xxxx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)93999[0-9]{5,5}$', 'Smart Infinity 0939 series: 99x xxxx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)94988[0-9]{5,5}$', 'Smart Infinity 0949 series: 88x xxxx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)94999[0-9]{5,5}$', 'Smart Infinity 0949 series: 99x xxxx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)908880[0-1][0-9]{3,3}$', 'Smart Infinity 0908 series: 8800 - 8801');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)90888020[0-9]{2,2}$', 'Smart Infinity 0908 series: 88020xx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)908880210[0-9]{1,1}$', 'Smart Infinity 0908 series: 880210x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)908880211[0-9]{1,1}$', 'Smart Infinity 0908 series: 880211x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)91893[0,3-9][0-9]{4,4}$', 'Smart Gold 0918 series: 930x, 933x to 939x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)91894[0-8][0-9]{4,4}$', 'Smart Gold 0918 series: 940x to 948x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9189[5-6][0-9]{5,5}$', 'Smart Gold 0918 series: 95x to 96x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9189(0(0[1-9][0-9]{3}|[1-9][0-9]{4})|[12][0-9]{5})$', 'Smart Gold 0918 series: 9001x to 9299x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^6391897([0-3][0-9]{4}|4[0-8][0-9]{3})$', 'Smart Gold 0918 series: 9700x to 9748x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)91897[5-9][0-9]{4,4}$', 'Smart Gold 0918 series: 9750x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9189[8-9][0-9]{5,5}$', 'Smart Gold 0918 series: 98xx to 9999x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9209[0,1,5-7,9][0-9]{5,5}$', 'Smart Gold 0920 series: 90-91, 95-97, 99');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)920932[6-9][0-9]{3,3}$', 'Smart Gold 0920 series: 9326x to 9329x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)920938[0-9]{4,4}$', 'Smart Gold 0920 series: 938');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)92094[5-9][0-9]{4,4}$', 'Smart Gold 0920 series: 945-949');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)92855[0-9]{5,5}$', 'Smart Gold 0928 series: 55');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9399[0-378][0-9]{5,5}$', 'Smart Gold 0939 series: 90x to 93x, 97x to 98x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)999(88|99)[0-9]{5,5}$', 'Smart Gold 0999 series: 88, 99');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)91999[0-9]{5,5}$', 'Smart Gold 0919 series: 99');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9088[1-4,6,9][0-9]{5,5}$', 'Smart Gold 0908 series: 81-84,86, 89');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)90887[2-9][0-9]{4,4}$', 'Smart Gold 0908 series: 872x to 879');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)90888021[2-9][0-9]{1,1}$', 'Smart Gold 0908 series: 880212x to 880219x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9088802[2-9][0-9]{2,2}$', 'Smart Gold 0908 series: 8802200 to  8802999 (88022xx to 88029xx)');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)908880[3-9][0-9]{3,3}$', 'Smart Gold 0908 series: 8803x to 8809x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)90888[1-9][0-9]{4,4}$', 'Smart Gold 0908 series: 881x to 889x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)947(89|99)[0-9]{5,5}$', 'Smart Gold 0947 series: 89, 99');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9479171[0-9]{3}$', 'Smart Gold 0947 series: 9171000 to 1999');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)947917[2-6][0-9]{3}$', 'Smart Gold 0947 series: 9172x to 9176x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)92092[0-8][0-9]{4,4}$', 'Addict Mobile Postpaid 0920 series: 920-928');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)920929[0-8][0-9]{3,3}$', 'Addict Mobile Postpaid 0920 series: 9290-9298');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)92094[0-4][0-9]{4,4}$', 'Addict Mobile Postpaid 0920 series: 940-944');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)94790[0-9]{5}$', 'Smart Bro Postpaid: 947 series: 90x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)92098[0-9]{5,5}$', 'Smart 3G Postpaid 920 series: 98xx');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)9285[0-2][0-9]{5,5}$', 'Smart 3G Postpaid 928 series: 50x to 52x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)94938[0-9]{5}$', 'Smart Bro Postpaid: 949 series: 38x');
insert into mobile_pattern values ('SMART', 'POSTPD', '^(63|0)94791[0-6][0-9]{4}$', 'Smart Bro Postpaid Micro: 910x to 916x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)908[1-7,9][0-9]{6,6}$', 'Smart Buddy 0908 series: 1-7,9xx xxxx');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)918[2,4-6][0-9]{6,6}$', 'Smart Buddy 0918 series: 2,4-6');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9183[0-2][0-9]{5,5}$', 'Smart Buddy 0918 series: 30x to 32x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)91833[0-6][0-9]{4,4}$', 'Smart Buddy 0918 series: 330x to 336x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)918338[0-9]{4}$', 'Smart Buddy 0918 series: 338xxxx');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)918339[0-9]{4,4}$', 'Smart Buddy 0918 series: 339x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9183[4-7][0-9]{5,5}$', 'Smart Buddy 0918 series: (inner interval)');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)91838[0-9]{5,5}$', 'Smart Buddy 0918 series: 339x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)91839[0-9]{5,5}$', 'Smart Buddy 0918 series: 39x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)919[3,4,6,8][0-9]{6,6}$', 'Smart Buddy 0919 series: 3, 4, 6, 8');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9192[0-1][0-9]{5,5}$', 'Smart Buddy 0919 series: 20x to 21x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)91922[1-9][0-9]{4,4}$', 'Smart Buddy 0919 series: 221x to 229x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9192[3-7,9][0-9]{5,5}$', 'Smart Buddy 0919 series: 23x to 27x, 29x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)91928[0-8][0-9]{4,4}$', 'Smart Buddy 0919 series: 280x to 288x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9195[0-3,5-9][0-9]{5,5}$', 'Smart Buddy 0919 series: 50-53, 55-59');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9199[0,2-8][0-9]{5,5}$', 'Smart Buddy 0919 series: 90, 92-98');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)920[1,4,6][0-9]{6,6}$', 'Smart Buddy 0920 series: 1, 4, 6');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9202[0-6][0-9]{5,5}$', 'Smart Buddy 0920 series: 20x to 26x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9205[0-8][0-9]{5,5}$', 'Smart Buddy 0920 series: 50x to 58x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)92059[0-7][0-9]{4,4}$', 'Smart Buddy 0920 series: 590x to 597x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)920599[0-9]{4,4}$', 'Smart Buddy 0920 series:  599x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9208[0-7,9][0-9]{5,5}$', 'Smart Buddy 0920 series: 80x to 87x, 89x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)920880[0-9]{4,4}$', 'Smart Buddy 0920 series: 880x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9202(7(0(0[5-9][0-9]{2}|[1-9][0-9]{3})|[1-9][0-9]{4})|[89][0-9]{5})$', 'Smart Buddy 0920 series: 27005x to 29999x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)921[2,4-7][0-9]{6,6}$', 'Smart Buddy 0921 series: 2, 4-7');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9213[0-2,4-9][0-9]{5,5}$', 'Smart Buddy 0921 series: 30-32, 34-39');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)92133[0-8][0-9]{4,4}$', 'Smart Buddy 0921 series: 330-338');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)921339[0-8][0-9]{3,3}$', 'Smart Buddy 0921 series: 3390-3398');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9219[5-9][0-9]{5,5}$', 'Smart Buddy 0921 series: 95-99');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)928[2-4,7][0-9]{6,6}$', 'Smart Buddy 0928 series: 2-4, 7');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)92859[0-9]{5,5}$', 'Smart Buddy 0928 series: 59');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9286[0-3,5-9][0-9]{5,5}$', 'Smart Buddy 0928 series: 60-63, 65-69');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9289[0,3-9][0-9]{5,5}$', 'Smart Buddy 0928 series: 90, 93-99');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)929[1-8][0-9]{6,6}$', 'Smart Buddy 0929 series: 1-8');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9299[5-7][0-9]{5,5}$', 'Smart Buddy 0929 series: 95-97');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9391[0-9]{6,6}$', 'Smart Buddy 0939 series: 10x to 19x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)939([2-5][0-9]{6}|6[0-5][0-9]{5})$', 'Smart Buddy 0939 series: 2x to 65x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)939(7[6-9][0-9]{5}|80[0-9]{5})$', 'Smart Buddy 0939 series: 76x to 80x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9399[4-6][0-9]{5}$', 'Smart Buddy 0939 series: 94x to 96x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)947([2-5][0-9]{6}|6[0-4][0-9]{5})$', 'Smart Buddy 0947 series: 2x to 64x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)947(69[0-9]{5}|7[0-9]{6}|8[0-8][0-9]{5})$', 'Smart Buddy 0947 series: 69x to 88x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9479[2-8][0-9]{5}$', 'Smart Buddy 0947 series: 92x to 98x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9491[1-9][0-9]{5,5}$', 'Smart Buddy 0949 series: 11-19');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9493[0-7,9][0-9]{5,5}$', 'Smart Buddy 0949 series: 30x to 37x, 39x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)94950[0-9]{5,5}$', 'Smart Buddy 0949 series: 50x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)949[4,6,7][0-9]{6,6}$', 'Smart Buddy 0949 series: 81-86, 89');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9499[0-8][0-9]{5,5}$', 'Smart Buddy 0949 series: 90x to 98x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)94939[0-9]{5}$', 'Smart Buddy 0949 series: 39x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)999[3-5,7][0-9]{6,6}$', 'Smart Buddy 0999 series: 3-5,7');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9996[5-9][0-9]{5,5}$', 'Smart Buddy 0999 series: 65x to 69x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9998[0-7,9][0-9]{5,5}$', 'Smart Buddy 0999 series: 80-87, 89');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9999[0-8][0-9]{5,5}$', 'Smart Buddy 0999 series: 90x to 98x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9991[5-9][0-9]{5,5}$', 'Smart Buddy 0999 series: 15x to 19x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9985[0-2][0-9]{5}$', 'Postpaid Smart Buddy 0998 series: 50x to 52x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)998[2-4][0-9]{6}$', 'Prepaid Smart Buddy 0998 series: 2x to 4x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9981[5-9][0-9]{5}$', 'Prepaid Smart Buddy 0998 series: 15x to 19x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9989[0-4][0-9]{5}$', 'Prepaid Smart Buddy 0998 series: 90x-94x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)947(1[4-9][0-9]{5}|[2-5][0-9]{6}|6[0-4][0-9]{5})$', 'Smart Buddy 947xx series: 14x to 64x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9281[0-9]{6,6}$', 'Smart Bro Prepaid: 098 series: 1x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)9476[5-8][0-9]{5}$', 'Smart Bro Prepaid: 947 series: 65x to 68x');
insert into mobile_pattern values ('SMART', 'BUDDY', '^(63|0)90800[0-9]{5}$', 'Smart NVS: 90800x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)907[1-9][0-9]{6,6}$', 'Smart TNT 0907 series: 1-9');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)909[1-9][0-9]{6,6}$', 'Smart TNT 0909 series: 1-9');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)910[1-6,8-9][0-9]{6,6}$', 'Smart TNT 0910 series: 1-6, 8, 9');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9107[0-8][0-9]{5,5}$', 'Smart TNT 0910 series: 70x to 78x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)91079([0-8][0-9]{4}|9[0-8][0-9]{3})$', 'Smart TNT 0910 series: 7900x to 7998x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)912[1-9][0-9]{6,6}$', 'Smart TNT 0912 series: 1-9');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9187[0-8][0-9]{5,5}$', 'Smart TNT 0918 series: 70x to 78x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)91879([0-8][0-9]{4}|9[0-8][0-9]{3})$', 'Smart TNT 0918 series: 7900x to 7998x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9197[0-9]{6,6}$', 'Smart TNT 0919 series: 7');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)920(3|7)[0-9]{6,6}$', 'Smart TNT 0920 series: 3, 7');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)92088[1-9][0-9]{4,4}$', 'Smart TNT 0920 series: 881-889');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9285[3,4,6-8][0-9]{5,5}$', 'Smart TNT 0928 series: 53-54, 56-58');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)930[1-9][0-9]{6,6}$', 'Smart TNT 0930 series: 1-9');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)946(1[1-9][0-9]{5}|[2-6][0-9]{6}|7[0-5][0-9]{5})$', 'Smart TNT 0946 series: 11x to 19x, 2x to 45x, 46x to 75x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)946[89][0-9]{6}$', 'Smart TNT 0946 series: 80x to 99x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9481[2-5][0-9]{5}$', 'Smart TNT 0948 series: 12x to 15x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9482[0-9]{6}$', 'Smart TNT 0948 series: 2x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9483[0-9][1-9][5-9][0-9]{3}$', 'Smart TNT 0948 series: 3015x to 3999x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)948[4-8][0-9]{6}$', 'Smart TNT 0948 series: 4x to 8x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9489[0-4][0-9]{5}$', 'Smart TNT 0948 series: 90x to 94x');
insert into mobile_pattern values ('SMART', 'TNT', '^(63|0)9489[6-9][0-9]{5}$', 'Smart TNT 0948 series: 96x to 99x');



drop view if exists powerapp_brand_dailyhits;
create view powerapp_brand_dailyhits as
select tran_dt, hits_pre unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, hits_pre email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, hits_pre chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, hits_pre photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, hits_pre social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, hits_pre speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, hits_pre line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, hits_pre snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, hits_pre tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, hits_pre waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, hits_pre wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, hits_pre wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, hits_tnt unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, hits_tnt email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, hits_tnt chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, hits_tnt photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, hits_tnt social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, hits_tnt speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, hits_tnt line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, hits_tnt snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, hits_tnt tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, hits_tnt waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, hits_tnt wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, hits_tnt wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, hits_ppd unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, hits_ppd email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, hits_ppd chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, hits_ppd photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, hits_ppd social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, hits_ppd speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, hits_ppd line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, hits_ppd snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, hits_ppd tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, hits_ppd waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, hits_ppd wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, hits_ppd wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, hits_tot unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, hits_tot email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, hits_tot chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, hits_tot photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, hits_tot social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, hits_tot speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, hits_tot line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, hits_tot snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, hits_tot tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, hits_tot waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, hits_tot wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, hits_tot wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt
;


drop view if exists powerapp_brand_dailyhits_summary;
create view powerapp_brand_dailyhits_summary as
select tran_dt,
       sum(unli_pre) unli_pre,
       sum(email_pre) email_pre,
       sum(chat_pre) chat_pre,
       sum(photo_pre) photo_pre,
       sum(social_pre) social_pre,
       sum(speed_pre) speed_pre,
       sum(line_pre) line_pre,
       sum(snapchat_pre) snapchat_pre,
       sum(tumblr_pre) tumblr_pre,
       sum(waze_pre) waze_pre,
       sum(wechat_pre) wechat_pre,
       sum(wiki_pre) wiki_pre,
       sum(unli_tnt) unli_tnt,
       sum(email_tnt) email_tnt,
       sum(chat_tnt) chat_tnt,
       sum(photo_tnt) photo_tnt,
       sum(social_tnt) social_tnt,
       sum(speed_tnt) speed_tnt,
       sum(line_tnt) line_tnt,
       sum(snapchat_tnt) snapchat_tnt,
       sum(tumblr_tnt) tumblr_tnt,
       sum(waze_tnt) waze_tnt,
       sum(wechat_tnt) wechat_tnt,
       sum(wiki_tnt) wiki_tnt,
       sum(unli_ppd) unli_ppd,
       sum(email_ppd) email_ppd,
       sum(chat_ppd) chat_ppd,
       sum(photo_ppd) photo_ppd,
       sum(social_ppd) social_ppd,
       sum(speed_ppd) speed_ppd,
       sum(line_ppd) line_ppd,
       sum(snapchat_ppd) snapchat_ppd,
       sum(tumblr_ppd) tumblr_ppd,
       sum(waze_ppd) waze_ppd,
       sum(wechat_ppd) wechat_ppd,
       sum(wiki_ppd) wiki_ppd,
       sum(unli_tot) unli_tot,
       sum(email_tot) email_tot,
       sum(chat_tot) chat_tot,
       sum(photo_tot) photo_tot,
       sum(social_tot) social_tot,
       sum(speed_tot) speed_tot,
       sum(line_tot) line_tot,
       sum(snapchat_tot) snapchat_tot,
       sum(tumblr_tot) tumblr_tot,
       sum(waze_tot) waze_tot,
       sum(wechat_tot) wechat_tot,
       sum(wiki_tot) wiki_tot     
from powerapp_brand_dailyhits
group by tran_dt;




drop view if exists powerapp_brand_dailyuniq;
create view powerapp_brand_dailyuniq as
select tran_dt, uniq_pre unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, uniq_pre email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, uniq_pre chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, uniq_pre photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, uniq_pre social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, uniq_pre speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, uniq_pre line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, uniq_pre snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, uniq_pre tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, uniq_pre waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, uniq_pre wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, uniq_pre wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, uniq_tnt unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, uniq_tnt email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, uniq_tnt chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, uniq_tnt photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, uniq_tnt social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, uniq_tnt speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, uniq_tnt line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, uniq_tnt snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, uniq_tnt tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, uniq_tnt waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, uniq_tnt wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, uniq_tnt wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, uniq_ppd unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, uniq_ppd email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, uniq_ppd chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, uniq_ppd photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, uniq_ppd social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, uniq_ppd speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, uniq_ppd line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, uniq_ppd snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, uniq_ppd tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, uniq_ppd waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, uniq_ppd wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, uniq_ppd wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, uniq_tot unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'UNLI' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, uniq_tot email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'EMAIL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, uniq_tot chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'CHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, uniq_tot photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'PHOTO' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, uniq_tot social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SOCIAL' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, uniq_tot speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SPEEDBOOST' group by tran_dt union 
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, uniq_tot line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'LINE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, uniq_tot snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'SNAPCHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, uniq_tot tumblr_tot, 0 waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'TUMBLR' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, uniq_tot waze_tot, 0 wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WAZE' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, uniq_tot wechat_tot, 0 wiki_tot from powerapp_brand_dailyrep where plan= 'WECHAT' group by tran_dt union
select tran_dt, 0 unli_pre, 0 email_pre, 0 chat_pre, 0 photo_pre, 0 social_pre, 0 speed_pre, 0 line_pre, 0 snapchat_pre, 0 tumblr_pre, 0 waze_pre, 0 wechat_pre, 0 wiki_pre, 0 unli_tnt, 0 email_tnt, 0 chat_tnt, 0 photo_tnt, 0 social_tnt, 0 speed_tnt, 0 line_tnt, 0 snapchat_tnt, 0 tumblr_tnt, 0 waze_tnt, 0 wechat_tnt, 0 wiki_tnt, 0 unli_ppd, 0 email_ppd, 0 chat_ppd, 0 photo_ppd, 0 social_ppd, 0 speed_ppd, 0 line_ppd, 0 snapchat_ppd, 0 tumblr_ppd, 0 waze_ppd, 0 wechat_ppd, 0 wiki_ppd, 0 unli_tot, 0 email_tot, 0 chat_tot, 0 photo_tot, 0 social_tot, 0 speed_tot, 0 line_tot, 0 snapchat_tot, 0 tumblr_tot, 0 waze_tot, 0 wechat_tot, uniq_tot wiki_tot from powerapp_brand_dailyrep where plan= 'WIKIPEDIA' group by tran_dt
;


drop view if exists powerapp_brand_dailyuniq_summary;
create view powerapp_brand_dailyuniq_summary as
select tran_dt,
       sum(unli_pre) unli_pre,
       sum(email_pre) email_pre,
       sum(chat_pre) chat_pre,
       sum(photo_pre) photo_pre,
       sum(social_pre) social_pre,
       sum(speed_pre) speed_pre,
       sum(line_pre) line_pre,
       sum(snapchat_pre) snapchat_pre,
       sum(tumblr_pre) tumblr_pre,
       sum(waze_pre) waze_pre,
       sum(wechat_pre) wechat_pre,
       sum(wiki_pre) wiki_pre,
       sum(unli_tnt) unli_tnt,
       sum(email_tnt) email_tnt,
       sum(chat_tnt) chat_tnt,
       sum(photo_tnt) photo_tnt,
       sum(social_tnt) social_tnt,
       sum(speed_tnt) speed_tnt,
       sum(line_tnt) line_tnt,
       sum(snapchat_tnt) snapchat_tnt,
       sum(tumblr_tnt) tumblr_tnt,
       sum(waze_tnt) waze_tnt,
       sum(wechat_tnt) wechat_tnt,
       sum(wiki_tnt) wiki_tnt,
       sum(unli_ppd) unli_ppd,
       sum(email_ppd) email_ppd,
       sum(chat_ppd) chat_ppd,
       sum(photo_ppd) photo_ppd,
       sum(social_ppd) social_ppd,
       sum(speed_ppd) speed_ppd,
       sum(line_ppd) line_ppd,
       sum(snapchat_ppd) snapchat_ppd,
       sum(tumblr_ppd) tumblr_ppd,
       sum(waze_ppd) waze_ppd,
       sum(wechat_ppd) wechat_ppd,
       sum(wiki_ppd) wiki_ppd,
       sum(unli_tot) unli_tot,
       sum(email_tot) email_tot,
       sum(chat_tot) chat_tot,
       sum(photo_tot) photo_tot,
       sum(social_tot) social_tot,
       sum(speed_tot) speed_tot,
       sum(line_tot) line_tot,
       sum(snapchat_tot) snapchat_tot,
       sum(tumblr_tot) tumblr_tot,
       sum(waze_tot) waze_tot,
       sum(wechat_tot) wechat_tot,
       sum(wiki_tot) wiki_tot     
from powerapp_brand_dailyhits
group by tran_dt;


drop view if exists powerapp_brand_daily_hits_optout;
create view powerapp_brand_daily_hits_optout as
select tran_dt, sum(hits_pre) hits_pre, sum(hits_tnt) hits_tnt, sum(hits_ppd) hits_ppd, sum(hits_tot) hits_tot, 0 optout_pre, 0 optout_tnt, 0 optout_ppd, 0 optout_tot from powerapp_brand_dailyrep where plan <> 'OPTOUT' group by tran_dt union
select tran_dt, 0 hits_pre, 0 hits_tnt, 0 hits_ppd, 0 hits_tot, hits_pre optout_pre, hits_tnt optout_tnt, hits_ppd optout_ppd, hits_tot optout_tot from powerapp_brand_dailyrep where plan= 'OPTOUT' group by tran_dt;

drop view if exists powerapp_brand_daily_hits_optout_summary;
create view powerapp_brand_daily_hits_optout_summary as
select tran_dt, sum(hits_pre) hits_pre, sum(hits_tnt) hits_tnt, sum(hits_ppd) hits_ppd, sum(hits_tot) hits_tot, sum(optout_pre) optout_pre, sum(optout_tnt) optout_tnt, sum(optout_ppd) optout_ppd, sum(optout_tot) optout_tot
from  powerapp_brand_daily_hits_optout
group by tran_dt;





select tran_dt, unli_pre, email_pre, chat_pre, photo_pre, social_pre, speed_pre, line_pre, snapchat_pre, tumblr_pre, waze_pre, wechat_pre, wiki_pre, 
                unli_tnt, email_tnt, chat_tnt, photo_tnt, social_tnt, speed_tnt, line_tnt, snapchat_tnt, tumblr_tnt, waze_tnt, wechat_tnt, wiki_tnt, 
                unli_ppd, email_ppd, chat_ppd, photo_ppd, social_ppd, speed_ppd, line_ppd, snapchat_ppd, tumblr_ppd, waze_ppd, wechat_ppd, wiki_ppd, 
                unli_tot, email_tot, chat_tot, photo_tot, social_tot, speed_tot, line_tot, snapchat_tot, tumblr_tot, waze_tot, wechat_tot, wiki_tot
from powerapp_brand_dailyhits_summary;


                                                                                                                                                                                                                                                       
+------------+
| plan       |
+------------+
| CHAT       |
| EMAIL      |
| LINE       |
| OPTOUT     |
| PHOTO      |
| SNAPCHAT   |
| SOCIAL     |
| SPEEDBOOST |
| TUMBLR     |
| UNLI       |
| WAZE       |
| WECHAT     |
| WIKIPEDIA  |
+------------+
 
 
 
 
select tran_dt, 
      sum(plan_3_pre) plan_3_pre, sum(plan_24_pre) plan_24_pre, sum(plan_tot_pre) plan_tot_pre, 
      sum(plan_3_tnt) plan_3_tnt, sum(plan_24_tnt) plan_24_tnt, sum(plan_tot_tnt) plan_tot_tnt, 
      sum(plan_3_ppd) plan_3_ppd, sum(plan_24_ppd) plan_24_ppd, sum(plan_tot_ppd) plan_tot_ppd
from powerapp_brand_chat_dailyhits group by tran_dt;

drop view if exists powerapp_brand_chat_dailyhits;
create view powerapp_brand_chat_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'CHAT' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'CHAT' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'CHAT' group by tran_dt;

drop view if exists powerapp_brand_unli_dailyhits;
create view powerapp_brand_unli_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'UNLI' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'UNLI' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'UNLI' group by tran_dt;

drop view if exists powerapp_brand_email_dailyhits;
create view powerapp_brand_email_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'EMAIL' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'EMAIL' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'EMAIL' group by tran_dt;

drop view if exists powerapp_brand_photo_dailyhits;
create view powerapp_brand_photo_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'PHOTO' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'PHOTO' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'PHOTO' group by tran_dt;

drop view if exists powerapp_brand_social_dailyhits;
create view powerapp_brand_social_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SOCIAL' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SOCIAL' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'SOCIAL' group by tran_dt;

drop view if exists powerapp_brand_boost_dailyhits;
create view powerapp_brand_boost_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SPEEDBOOST' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SPEEDBOOST' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'SPEEDBOOST' group by tran_dt;

drop view if exists powerapp_brand_boost_dailyhits;
create view powerapp_brand_boost_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SPEEDBOOST' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SPEEDBOOST' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'SPEEDBOOST' group by tran_dt;

drop view if exists powerapp_brand_line_dailyhits;
create view powerapp_brand_line_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'LINE' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'LINE' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'LINE' group by tran_dt;

drop view if exists powerapp_brand_snapchat_dailyhits;
create view powerapp_brand_snapchat_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SNAPCHAT' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'SNAPCHAT' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'SNAPCHAT' group by tran_dt;

drop view if exists powerapp_brand_tumblr_dailyhits;
create view powerapp_brand_tumblr_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'TUMBLR' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'TUMBLR' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'TUMBLR' group by tran_dt;

drop view if exists powerapp_brand_waze_dailyhits;
create view powerapp_brand_waze_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'WAZE' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'WAZE' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'WAZE' group by tran_dt;

drop view if exists powerapp_brand_wechat_dailyhits;
create view powerapp_brand_wechat_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'WECHAT' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'WECHAT' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'WECHAT' group by tran_dt;

drop view if exists powerapp_brand_wiki_dailyhits;
create view powerapp_brand_wiki_dailyhits as
select tran_dt, hits_pre plan_3_pre, 0 plan_24_pre, 0 plan_tot_pre, hits_tnt plan_3_tnt, 0 plan_24_tnt, 0 plan_tot_tnt, hits_ppd plan_3_ppd, 0 plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'WIKIPEDIA' and plan_exp='3H' group by tran_dt union
select tran_dt, 0 plan_3_pre, hits_pre plan_24_pre, 0 plan_tot_pre, 0 plan_3_tnt, hits_tnt plan_24_tnt, 0 plan_tot_tnt, 0 plan_3_ppd, hits_ppd plan_24_ppd, 0 plan_tot_ppd                from powerapp_brand_expiry_dailyrep where plan= 'WIKIPEDIA' and plan_exp='24H' group by tran_dt union
select tran_dt, 0 plan_3_pre, 0 plan_24_pre, sum(hits_pre) plan_tot_pre, 0 plan_3_tnt, 0 plan_24_tnt, sum(hits_tnt) plan_tot_tnt, 0 plan_3_ppd, 0 plan_24_ppd, sum(hits_ppd) plan_tot_ppd from powerapp_brand_expiry_dailyrep where plan= 'WIKIPEDIA' group by tran_dt;

